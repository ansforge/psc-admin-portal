<!--

    Copyright © 2022-2024 Agence du Numérique en Santé (ANS) (https://esante.gouv.fr)

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.

-->
<h3>Traitement des alertes</h3>
@if(queryStatus) {

<div 
  [class.o-alert--info]="queryStatus.status===qs.PENDING" 
  [class.o-alert--success]="queryStatus.status===qs.OK" 
  [class.o-alert--error]="queryStatus.status===qs.KO" 
  class="o-alert" 
  role="status">

  <div class="o-alert__icon">
    <svg 
      class="svg-icon" 
      [class.svg-circle-check]="queryStatus.status===qs.OK"
      [class.svg-circle-cross]="queryStatus.status===qs.KO"
      aria-hidden="true" 
      focusable="false">
    @if (queryStatus.status===qs.OK) {
      <use xlink:href="svg-icons/icon-sprite.svg#circle-check"></use>
    } @else if(queryStatus.status===qs.KO) {
      <use xlink:href="svg-icons/icon-sprite.svg#circle-cross"></use>
    } @else {
      <use xlink:href="svg-icons/icon-sprite.svg#circle-info"></use>
    }
    </svg>
  </div>

@if(queryStatus.status===qs.KO){
  <p>Erreur de déclenchement de l'opération.</p>
}

  <p>{{queryStatus.message}}</p>
  <button type="button" class="btn btn--close btn--icon-only" (click)="forgetStatus()">
    <svg class="svg-icon svg-close" aria-hidden="true" focusable="false"><use xlink:href="svg-icons/icon-sprite.svg#close"></use></svg>
    <span class="sr-only">Masquer ce message</span>
  </button>
</div>

}
<div class="form-group bg-gray-100 rounded-md">
  <h4>Selon le type d'alerte, vous pouvez 
    <svg aria-hidden="true" class="svg-icon svg-mail" focusable="false">
      <use xlink:href="svg-icons/icon-sprite.svg#mail "></use>
    </svg>
  :</h4>
  <div class="btn-group form-group row">
      <button type="button" class="btn btn--ghost btn--primary" (click)="showExcludes()">Force continue load with exclude</button>
      <button type="button" class="btn btn--plain btn--primary" (click)="forceContinue()">Force continue</button>
  </div>
@if(excludesVisible) {
  <div class="form-group row">
    <fieldset class="lvl2">
      <legend class="redlegend">Force continue load with exclude :</legend>
      @for(excludeModel of excludeCheckModel; track excludeModel) {
        <div class="custom-control custom-checkbox">
          <input class="lvl2" [id]="excludeModel.operation.code" [name]="excludeModel.operation.code" type="checkbox" [(ngModel)]="excludeModel.selected" [ngModelOptions]="{standalone: true}" />
          <label for="excludeModel.operation.code">{{excludeModel.operation.displayName}}</label>
        </div>
      }
    </fieldset>
  </div>
}
</div>